<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Profile - Food Nutrition</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body{font-family:Inter,system-ui,Arial;background:linear-gradient(180deg,#071024,#071a2e);color:#e6eef8;padding:32px}
        .card{max-width:720px;margin:24px auto;background:rgba(255,255,255,0.03);padding:20px;border-radius:12px;border:1px solid rgba(255,255,255,0.03)}
        h1{margin:0 0 10px}
        .meta{color:#9fb3d9;font-size:13px}
        .row{display:flex;align-items:center;justify-content:space-between}
        .btn{padding:8px 12px;border-radius:10px;background:#00b4ff;color:#071028;border:none;font-weight:700;cursor:pointer}
        .muted{color:#9fb3d9;font-size:13px}

        /* Streak badge (compact, matches screenshot) */
        .streak-badge{display:inline-grid;place-items:center;width:40px;height:40px;border-radius:8px;font-weight:900;color:#fff;font-size:16px;box-shadow:0 6px 14px rgba(0,0,0,0.34);position:relative;padding:4px;text-decoration:none;z-index:10;border:1px solid rgba(255,255,255,0.04)}
        .streak-badge .streak-fire{position:absolute;left:6px;top:6px;font-size:14px;filter:drop-shadow(0 1px 4px rgba(0,0,0,0.12))}
        .streak-badge .streak-num{font-size:16px;font-weight:900;color:#071028}
        /* Dashboard modifier: slightly larger for home page */
        .streak-badge--home{width:64px;height:64px;border-radius:12px;font-size:20px;background:var(--accent-solid);color:#071028}
        .streak-badge--home .streak-fire{font-size:20px}
        .streak-badge--home .streak-num{font-size:20px}
        .streak-increment{animation:streak-pop .95s cubic-bezier(.2,.9,.2,1)}
        @keyframes streak-pop{0%{transform:scale(1);opacity:1}40%{transform:scale(1.28);opacity:1}100%{transform:scale(1);opacity:1}}
    </style>
</head>
<body>
<div class="card">
    <div class="row">
        <div>
            <h1>Profile</h1>
            <div class="meta">Account details</div>
        </div>
        <div style="display:flex;align-items:center;gap:12px">
            {% if user.is_authenticated %}
            <div style="display:flex;align-items:center;gap:8px">
                <div style="font-size:12px;color:#9fb3d9">Streak</div>
                <a href="/analytics/logs/?date={{ streak_date }}" style="text-decoration:none">
                    <div class="streak-badge" data-count="{{ streak.count }}" data-color="{{ streak.color }}" role="img" aria-label="{{ streak.count }} day streak">
                        <span class="streak-fire">ðŸ”¥</span>
                        <span class="streak-num">{{ streak.count }}</span>
                    </div>
                </a>
            </div>
            {% endif %}
            <a href="/" class="btn">Back to Dashboard</a>
        </div>
    </div>

    <div style="margin-top:18px">
        <p><strong>Username</strong></p>
        <div class="muted">{{ user_obj.username }}</div>

        <p style="margin-top:12px"><strong>Email</strong></p>
        <div class="muted">{{ user_obj.email|default:'â€”' }}</div>

        <p style="margin-top:12px"><strong>Joined</strong></p>
        <div class="muted">{{ user_obj.date_joined }}</div>

        <div style="margin-top:18px">
            <a href="/logout/" class="btn">Logout</a>
        </div>
    </div>
</div>
<script>
(function(){
    try{
        const b = document.querySelector('.streak-badge[data-count]');
        if(!b) return;
        b.style.background = b.dataset.color || b.style.background;
        const cur = Number(b.dataset.count || 0);
        const key = 'fn_last_streak';
        const prev = Number(localStorage.getItem(key) || 0);
        if(cur > prev && prev >= 0){ b.classList.add('streak-increment'); setTimeout(()=>b.classList.remove('streak-increment'), 1400); }
        localStorage.setItem(key, String(cur));
    }catch(e){console.warn('streak init',e)}
})();
</script>
</body>
</html>